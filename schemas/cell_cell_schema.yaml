id: https://brain-connects.org/ic3-cell-cell-schema
name: cell_cell_schema
description: Schema for connectivity measurements that are cell to cell.
imports:
  - base_schema
  - core_schema
  - zarr_schema

classes:
  CellCellConnectivityLong:
    description: Long-form connectivity measurements between pairs of cells.
    slots:
      - id
      - description
      - presynaptic_cell
      - postsynaptic_cell
      - measurement_type
      - modality
      - value
      - unit
    mixins:
      - ProjectScoped
    slot_usage:
      measurement_type:
        range: SynapticMeasurementType
      modality:
        range: Modality
      presynaptic_cell:
        range: DataItem
        inlined: false
        description: The presynaptic cell for this measurement.
      postsynaptic_cell:
        range: DataItem
        inlined: false
        description: The postsynaptic cell for this measurement.
      value:
        required: true
        range: float
        description: Numeric value quantifying connectivity between the presynaptic and postsynaptic cell.
      unit:
        required: true
        range: Unit
  CellCellMeasurementMatrix:
    description: Aggregated projection measurements for a cohort (e.g., all cells) for a single measurement type.
    slots:
      - id
      - description
      - presynaptic_index
      - postsynaptic_index
      - measurement_type
      - modality
      - values
      - unit
    mixins:
      - ProjectScoped
    slot_usage:
      measurement_type:
        range: SynapticMeasurementType
      description:
        range: string
        description: Free-text description of what this measurement matrix represents.
      modality:
        range: Modality
      presynaptic_index:
        multivalued: true
        range: DataItem
        inlined: false
        description: Ordered data items defining rows of the matrix, where each row is a presynpatic data item (cell, injection location, etc).
      postsynaptic_index:
        multivalued: true
        range: DataItem
        inlined: false
        description: Ordered data items defining columns of the matrix, where each column is a postsynaptic data item (cell, region, etc).
      values:
        required: true
        range: ZarrArray
        description: |- 
          Zarr array containing matrix values quantifying connectivity with shape (presynaptic_index x postsynaptic_index).
          NaN values reflect 'unmeasured' connectivity.
      unit:
        required: true
        range: Unit

slots:
  dataitem_id:
    description: The DataItem for which projection measurements are reported.
  measurement_type:
    description: The specific projection measurement type (enum) for this set.
  values:
    description: Numeric data values; interpretation depends on measurement_type.
  value:
    description: Numeric data value; interpretation depends on measurement_type.
  zarr_array:
    description: Reference to a zarr array containing the matrix data.
  postsynaptic_index:
    description: A list of DataItems indexing the columns of the matrix.
  presynaptic_index: 
    description: A list of DataItems indexing the rows of the matrix.
  presynaptic_cell:
    description: The presynaptic cell for this measurement.
  postsynaptic_cell:
    description: The postsynaptic cell for this measurement.
  description_text:
    description: Free-text description for measurement type metadata.
  default_unit:
    description: Default unit recommended for this measurement type.